# DongFeng
判斷出excel上訂單之排定交貨日有異動時，發EMAIL通知業務。
資料說明
1.	pk (不能重複) = 訂單編號 + 項次
2.	df = 昨天的資料 [4/1-5/1] = [4/1 + 4/2-5/1(交期更改前+未改的)]
3.	df1 = 今天的資料 [4/2-5/2] = [5/2 + 4/2-5/1(交期更改後+未改的)]
4.	tmp [4/1 + 5/2 + 4/2-5/1(交期更改前+交期更改後+未改的*2)]<br>
      = 昨天的資料 + 今天的資料 (全部以新row加入)<br>
      = [4/1 + 4/2-5/1(交期更改前+未改的)] + [5/2 + 4/2-5/1(交期更改後+未改的)]<br>
      = df + df1
5.	df2 [4/1 + 5/2 + 4/2-5/1(交期更改前+交期更改後+未改的)]
      = 昨天跟今天所有不重複的資料 (交期更改前後pk相同)
      = 昨天的資料 + 今天的資料 - 兩天中每個column都一樣的資料
      = [4/1 + 5/2 + 4/2-5/1(交期更改前+交期更改後+未改的*2)] – [4/2-5/1未改的]
      = tmp - tmp中每個column都一樣的資料
6.	dupl [4/1 + 5/2 + 4/2-5/1(未改的)]
      = df2 - df2中pk一樣時的所有資料
      = df2刪除所有pk一樣的資料
7.	first [4/1 + 4/2-5/1(交期更改前+未改的)]
      = df2 - df2中pk一樣時今天的資料
      = df2中pk一樣時保留昨天的資料，刪除今天的
8.	last [5/2 + 4/2-5/1(交期更改後+未改的)]
      = df2 - df2中pk一樣時昨天的資料
      = df2中pk一樣時保留今天的資料，刪除昨天的
9.	old [4/2-5/1交期更改前的]
      = [4/1 + 4/2-5/1(交期更改前+未改的)] + [4/1 + 4/2-5/1交期未改的] – [5/2 + 4/2-5/1交期未改的]
      = first + dupl – 兩者pk一樣的資料
10.	new [4/2-5/1交期更改後的]
      = [5/2 + 4/2-5/1(交期更改後+未改的)] + [5/2 + 4/2-5/1交期未改的] – [5/2 + 4/2-5/1交期未改的]
      = last + dupl – 兩者pk一樣的資料
